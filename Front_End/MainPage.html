<!DOCTYPE html>
<html>
<title>IMS</title>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="http://www.w3schools.com/lib/w3.css">
<style type="text/css">
.button 
{
  border: 1px solid #0a3c59;
  background: #156bad;
  background: -webkit-gradient(linear, left top, left bottom, from(#2195f3), to(#156bad));
  background: -webkit-linear-gradient(top, #2195f3, #156bad);
  background: -moz-linear-gradient(top, #2195f3, #156bad);
  background: -ms-linear-gradient(top, #2195f3, #156bad);
  background: -o-linear-gradient(top, #2195f3, #156bad);
  background-image: -ms-linear-gradient(top, #2195f3 0%, #156bad 100%);
  padding: 10.5px 21px;
  -webkit-border-radius: 6px;
  -moz-border-radius: 6px;
  border-radius: 6px;
  -webkit-box-shadow: rgba(255,255,255,0.4) 0 1px 0, inset rgba(255,255,255,0.4) 0 1px 0;
  -moz-box-shadow: rgba(255,255,255,0.4) 0 1px 0, inset rgba(255,255,255,0.4) 0 1px 0;
  box-shadow: rgba(255,255,255,0.4) 0 1px 0, inset rgba(255,255,255,0.4) 0 1px 0;
  text-shadow: #7ea4bd 0 1px 0;
  color: #ffffff;
  font-size: 14px;
  font-family: helvetica, serif;
  text-decoration: none;
  vertical-align: middle;
}
.button:hover 
{
  border: 1px solid #0a3c59;
  text-shadow: #1e4158 0 1px 0;
  background: #156bad;
  background: -webkit-gradient(linear, left top, left bottom, from(#2195f3), to(#156bad));
  background: -webkit-linear-gradient(top, #2195f3, #156bad);
  background: -moz-linear-gradient(top, #2195f3, #156bad);
  background: -ms-linear-gradient(top, #2195f3, #156bad);
  background: -o-linear-gradient(top, #2195f3, #156bad);
  background-image: -ms-linear-gradient(top, #2195f3 0%, #156bad 100%);
  color: #000000;
}
.button:active 
{
  text-shadow: #1e4158 0 1px 0;
  border: 1px solid #0a3c59;
  background: #2195f3;
  background: -webkit-gradient(linear, left top, left bottom, from(#156bad), to(#156bad));
  background: -webkit-linear-gradient(top, #156bad, #2195f3);
  background: -moz-linear-gradient(top, #156bad, #2195f3);
  background: -ms-linear-gradient(top, #156bad, #2195f3);
  background: -o-linear-gradient(top, #156bad, #2195f3);
  background-image: -ms-linear-gradient(top, #156bad 0%, #2195f3 100%);
  color: #000000;
}
#id_search_bar
{
  width:500px;
  height:40px;
  color:black;
}
table 
{
 	table-layout: fixed;
}
table td:nth-child(7) 
{
 	word-wrap: break-word;
 	width: 50%;
 	max-width: 1px;
}
#table-wrapper 
{
 	position:relative;
}
#table-scroll 
{
 	height:175px;
 	overflow:auto;  
 	margin-top:20px;
}
#table-wrapper table 
{
 	width:100%;
}
#table-wrapper table * 
{
	background:gray;
 	color:black;
}
#table-wrapper table thead th .text 
{
	position:absolute;   
 	top:-20px;
 	z-index:2;
 	height:20px;
 	width:35%;
 	border:1px solid red;
}
textarea 
{
  resize: none;
  color:black;
}
th
{
  cursor:pointer;
}

</style>

<script>

/****************************************************************
Function:  populateForms()
Description: This function run all data retrieval functions so 
that all data fields are populated on page load.  Also gets a 
SID from the server
*****************************************************************/
function populateForms()
{
	setSID();
	cdm_getClassData();
	loadBrowser();
	loadLog();
}

/****************************************************************
Function:  getSID()
Description: Gets a SID from the server and creates a local cookie.
*****************************************************************/
function setSID()
{

  var xhttp = new XMLHttpRequest(); 
  xhttp.open("POST", "GenerateSID.php", false);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(); 
  
  
  var SIDResponse = xhttp.responseText;

  if(SIDResponse == "SIDError")
  {
	alert("GET SID Error. SID Missing");
	return;
  }
	
  document.cookie=SIDResponse;

  document.getElementById("id_main_SIDDisplay").innerHTML = SIDResponse;

  
  return;
  
}

function getSID()
{
  return document.cookie;
}


function loadBrowser()
{

  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() 
  {
    if (xhttp.readyState == 4 && xhttp.status == 200) 
    {
      parseXMLResponse(xhttp);
    }
  };
  xhttp.open("POST", "RetrieveBrowserData.php", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send("SID="+getSID()); 
}

function loadLog()
{


  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() 
  {
    if (xhttp.readyState == 4 && xhttp.status == 200) 
    {
      parseXMLResponse(xhttp);
    }
  };
  xhttp.open("POST", "RetrieveLog.php", true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send("SID="+getSID()+"&LogLevel=All"); 
}

/****************************************************************
Function:  showAutocomplete()
Description: Creates a datalist to show all autocomplete matches
for a partial search string.
*****************************************************************/
function showAutocomplete(partialStr)
{


  //Check for a selection	
  //from http://stackoverflow.com/questions/30022728/perform-action-when-clicking-html5-datalist-option
  var val = document.getElementById("id_search_bar").value;
  var opts = document.getElementById('id_search_queryList').childNodes;
  for (var i = 0; i < opts.length; i++) 
  {
	if (opts[i].value === val) 
	{
	// An item was selected from the list!
	//close datalist and launch item load functions.
	document.getElementById('id_search_queryList').style.display = 'none';
	getQuickUpdateData(opts[i].value);
	return;
	}
  }
  
  sendBackendRequest("QueryAutocomplete.php","SID="+getSID()+"&Filter="+ partialStr);
}


/****************************************************************
Function:  getQuickUpdateData()
Description: Requests data for a single item number.
*****************************************************************/
function getQuickUpdateData(partNumber)
{
  sendBackendRequest("RetrieveItemData.php","SID="+getSID()+"&PartNumber="+ partNumber);
}



/****************************************************************
Function:  createNewItem()
Description: Sends new Item data to the server for saving. 
Synchronous mode is used to ensure previous processes are completed
before the next is started. 
*****************************************************************/
function createNewItem()
{


  //Input Verification code goes here.
  var partNumber = document.getElementById("id_ivm_itemNumber").value;
  var qty = document.getElementById("id_ivm_qty").value;
  var threshold = document.getElementById("id_ivm_thresh").value;
  var location = document.getElementById("id_ivm_location").value;
  var description = document.getElementById("id_ivm_desc").value;
  var type = document.getElementById("id_ivm_type").value;
  var value = document.getElementById("id_ivm_value").value;
  var supplierName = document.getElementById("id_ivm_supplierName").value;
  var supplierPN = document.getElementById("id_ivm_supplierPN").value;
  var link = document.getElementById("id_ivm_link").value;
	
  //Create new Item record
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() 
  {
    if (xhttp.readyState == 4 && xhttp.status == 200) 
    {
      parseXMLResponse(xhttp);
    }
  };
  
  xhttp.open("POST", "CreateNewItem.php", false);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send("SID="+getSID()+"&PartNumber="+partNumber); 
  
  var returnVal = parseXMLResponse(xhttp);
  
  if(returnVal == false)
  {
	alert("Part Number Creation Error");
	return;
  }
	
  

  if(qty != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");  
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Quantity&Value="+qty);
  }
  
  
  
  if(threshold != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Ordering_Threshold&Value="+threshold);
  }

  
  if(location != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Location&Value="+location);
  }
  
  if(description != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Description&Value="+description);
  }
  
  if(type != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Type&Value="+type);
  }
  
  if(value != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Value&Value="+value);
  }
  
  if(supplierName != "")
  { 
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Suppliers_Name&Value="+supplierName);
  }
  
  if(supplierPN != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Supplier_Part_Number&Value="+supplierPN);
  }
  
  if(link != "")
  {  
    xhttp.open("POST", "ModifyItem.php", false);
    xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
	xhttp.send("SID="+getSID()+"&PartNumber="+partNumber+"&Field=Item_Link&Value="+link);
  }
  
}

/****************************************************************
Function:  sendBackendRequest()
Description: Sets up and sends a XMLHttpRequest in POST mode to 
a specified PHP script.
*****************************************************************/
function sendBackendRequest(PHPscript,postOptions)
{
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() 
  {
    if (xhttp.readyState == 4 && xhttp.status == 200) 
    {
      parseXMLResponse(xhttp);
    }
  };
  xhttp.open("POST", PHPscript, true);
  xhttp.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
  xhttp.send(postOptions);
  
  return;
}


function parseXMLResponse(xml)
{

  var i;
  var xmlDoc = xml.responseXML;
  var tableBrowser;
  var tableLog;

  //error check for null XML response.
  if(xmlDoc == null)
  {
    //do something
    //break and report error. NO script yet
  }   
  


  //handle xml entries
  var status = xmlDoc.getElementsByTagName("STATUS");
  var browser = xmlDoc.getElementsByTagName("BROWSER");
  var log = xmlDoc.getElementsByTagName("LOG");
  var autoComplete = xmlDoc.getElementsByTagName("QUERY_SUGGEST");
  var quickAccess = xmlDoc.getElementsByTagName("QACCESS");
  var classData = xmlDoc.getElementsByTagName("CLASS_DATA");


  if(status.length > 0)
  {
	var statusCode = status[0].getElementsByTagName("STATUS_CODE")[0].childNodes[0].nodeValue;
	var statusMessage = status[0].getElementsByTagName("STATUS_MESSAGE")[0].childNodes[0].nodeValue;
  
	document.getElementById("status_code").innerHTML = statusCode;
	document.getElementById("status_message").innerHTML = statusMessage;
  
	//check status code and throw and alert if a fail occurred.
	if(statusCode != "0")
	{
		alert("Server Error with message:" + statusMessage);
		return false;
	}
	
  
  }
  else //Bad XML Response format if STATUS is missing
  {
	alert("Bad XML Response Format");

	return false;
  }

  
  if(autoComplete.length > 0)
  {
	var autoCompleteList = autoComplete[0].getElementsByTagName("SUGGESTION");	
	var autoCompleteHtml;
	
	//check for null data
    if(autoCompleteList == null)
    {
      //do something
    }
	
	
    for( i = 0; i < autoCompleteList.length; i++)
	{
		autoCompleteHtml += "<option value=\""
		+autoCompleteList[i].getElementsByTagName("Name")[0].childNodes[0].nodeValue 
		+"\" style=\"color:black\">"
		+autoCompleteList[i].getElementsByTagName("Type")[0].childNodes[0].nodeValue 
		+" - "
		+autoCompleteList[i].getElementsByTagName("Description")[0].childNodes[0].nodeValue
		+"</option>";
	}
	
    document.getElementById("id_search_queryList").innerHTML = autoCompleteHtml;

	
  }
  

  if(quickAccess.length > 0)
  {
	//quick access form
	document.getElementById("id_qa_ID").innerHTML = quickAccess[0].getElementsByTagName("Name")[0].childNodes[0].nodeValue;
	document.getElementById("id_qa_Description").innerHTML = quickAccess[0].getElementsByTagName("Description")[0].childNodes[0].nodeValue;
	document.getElementById("id_qa_Quantity").innerHTML = quickAccess[0].getElementsByTagName("Quantity")[0].childNodes[0].nodeValue;
	
	//add item modal dialog
	document.getElementById("id_ivm_itemNumber").value = quickAccess[0].getElementsByTagName("Name")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_desc").value = quickAccess[0].getElementsByTagName("Description")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_supplierPN").value = quickAccess[0].getElementsByTagName("Supplier_Part_Number")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_qty").value = quickAccess[0].getElementsByTagName("Quantity")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_location").value = quickAccess[0].getElementsByTagName("Location")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_type").value = quickAccess[0].getElementsByTagName("Type")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_thresh").value = quickAccess[0].getElementsByTagName("Ordering_Threshold")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_value").value = quickAccess[0].getElementsByTagName("Value")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_supplierName").value = quickAccess[0].getElementsByTagName("Suppliers_Name")[0].childNodes[0].nodeValue;
	document.getElementById("id_ivm_link").value = quickAccess[0].getElementsByTagName("Item_Link")[0].childNodes[0].nodeValue;

	
  }  
  

  
  if(log.length > 0)
  {
    var log_entry = log[0].getElementsByTagName("LOG_ENTRY");

    //check for null data
    if(log_entry == null)
    {
      //do something
    }


    tableLog = "<table><tr>" +
               "<th>Test</th>";
    document.getElementById("log").innerHTML = "Test-erino:";
    for( i = 0; i < log_entry.length; i++)
    {
      tableLog += ", " + i;
    }

    tableLog += "</table>";
    document.getElementById("log").innerHTML = tableLog;

  }
  

  
  if(browser.length > 0) //Browser section present
  { 
    var browser_entry = browser[0].getElementsByTagName("BROWSER_ENTRY");

    //check for null data
    if(browser_entry == null)
    {
      //do something
    }
    
    tableBrowser = "<table><tr>" +
            "<th>Part Number</th>" + 
            "<th>Quantity</th>" + 
            "<th>Type</th>" +
            "<th>Value</th>" +
            "<th>Location</th>" +
            "<th>Supplier Part Number</th>" +
            "<th>Ordering Threshold</th>" +
            "<th>Description</th>";
    for( i = 0; i < browser_entry.length; i++)
    {

      tableBrowser += "<tr>" + "<td>" + browser_entry[i].getElementsByTagName("Name")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Quantity")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Type")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Value")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Location")[0].childNodes[0].nodeValue + "</td>" +                        
                        "<td>" + browser_entry[i].getElementsByTagName("Supplier_Part_Number")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Ordering_Threshold")[0].childNodes[0].nodeValue + "</td>" +
                        "<td>" + browser_entry[i].getElementsByTagName("Description")[0].childNodes[0].nodeValue + "</td>" +
                        "</tr>";
    }

    tableBrowser += "</table>"
    document.getElementById("browser").innerHTML = tableBrowser;	
  } 
  

  
  if(classData.length > 0)
  { 

	var class_entry = classData[0].getElementsByTagName("CLASS_ENTRY");
	
	//check for null data
    if(class_entry == null)
    {
      //do something
    }
	var headerLabelID = "ID";
	var headerLabelClass = "Class Name";
	var headerLabelPN = "Part Number";
	var headerLabelQty = "Quantity";
	var headerLabelDate = "Date";
	
    var currentSort = document.getElementById("id_cmd_sortInfo").innerHTML;

	
	if(currentSort != "None")
	{
	  var currentSortSplit = currentSort.split(":");
	  var currentSortCol = currentSortSplit[0];
	  var currentSortDir = currentSortSplit[1];
	  
	  if(currentSortCol == "ID")
	  {
		if(currentSortDir == "ASC")
		{
		  headerLabelID = "ID&#9650;"; //Arrow up
		}
		else
		{
		  headerLabelID = "ID&#9660;";//Arrow Down
		}		
	  }
	  
	  if(currentSortCol == "Class")
	  {
		if(currentSortDir == "ASC")
		{
		  headerLabelClass = "Class Name&#9650;"; //Arrow up
		}
		else
		{
		  headerLabelClass = "Class Name&#9660;";//Arrow Down
		}		
	  }
	  
	  if(currentSortCol == "Part")
	  {
		if(currentSortDir == "ASC")
		{
		  headerLabelPN = "Part Number&#9650;";
		}
		else
		{
		  headerLabelPN = "Part Number&#9660;";
		}		
	  }
	  
	  
	  if(currentSortCol == "Quantity")
	  {
		if(currentSortDir == "ASC")
		{
		  headerLabelQty = "Quantity&#9650;";
		}
		else
		{
		  headerLabelQty = "Quantity&#9660;";
		}		
	  }
	  
	  
	  if(currentSortCol == "Date")
	  {
		if(currentSortDir == "ASC")
		{
		  headerLabelDate = "Date&#9650;";
		}
		else
		{
		  headerLabelDate = "Date&#9660;";
		}		
	  }	
	}

	
	//Table header
	tableClassData = "<table class=\"w3-table w3-bordered w3-border w3-striped w3-hoverable\" ><tr>" +
			"<col width=\"50\">"+
			"<th class=\"w3-border\" onclick=\"cdm_tableSort('ID')\">"+headerLabelID+"</th>" +
            "<th class=\"w3-border\" onclick=\"cdm_tableSort('Class')\">"+headerLabelClass+"</th>" + 
            "<th class=\"w3-border\" onclick=\"cdm_tableSort('Part')\">"+headerLabelPN+"</th>" + 
            "<th class=\"w3-border\" onclick=\"cdm_tableSort('Quantity')\">"+headerLabelQty+"</th>" +
            "<th class=\"w3-border\" onclick=\"cdm_tableSort('Date')\">"+headerLabelDate+"</th>";
	//table data
	for( i = 0; i < class_entry.length; i++)
    {
	
		var id = class_entry[i].getElementsByTagName("Id")[0].childNodes[0].nodeValue;
		var className = class_entry[i].getElementsByTagName("Class")[0].childNodes[0].nodeValue;
		var part = class_entry[i].getElementsByTagName("Part")[0].childNodes[0].nodeValue;
		var qty = class_entry[i].getElementsByTagName("Quantity")[0].childNodes[0].nodeValue;
		var date = class_entry[i].getElementsByTagName("Date")[0].childNodes[0].nodeValue;
	
	
		tableClassData += "<tr onclick=\"cdm_loadRow('" + 
						id + "','" +
						className + "','" +
						part + "','" +
						qty + "','" +
						date +
						"')\">" + 
						"<td class=\"w3-border\">" + id + "</td>" +
						"<td class=\"w3-border\">" + className + "</td>" +
                        "<td class=\"w3-border\">" + part + "</td>" +
                        "<td class=\"w3-border\">" + qty + "</td>" +
                        "<td class=\"w3-border\">" + date + "</td>" +                   
                        "</tr>";								
	}

    tableClassData += "</table>"

	
	document.getElementById("id_cdm_table").innerHTML = tableClassData;

  }  
  

  return true; 
  
}

/****************************************************************
Function:  ivm_autoPN()
Description: Generates an Item Number suggestion based on form 
inputs.
*****************************************************************/
function ivm_autoPN()
{

  var partNumber = "";
  if(document.getElementById("id_ivm_type").value != "")
  {
	switch(document.getElementById("id_ivm_type").value)
	{
	  case "Capacitor":
		partNumber = "C";
		break;
	  case "Resistor":
		partNumber = "R";
		break;
	  case "Inductor":
		partNumber = "I";
		break;
	  case "Equipment":
		partNumber = "E";
		break;
	  case "Transistor":
		partNumber = "Q";
		break;
	  case "Transformer":
		partNumber = "T";
		break;
	  default:
		partNumber = "O";
		break;
	}
	
  }
  
  if(document.getElementById("id_ivm_value").value != "")
  {
	partNumber += document.getElementById("id_ivm_value").value;
  }
  else
  {
	partNumber += "XXX";
  }
  
  partNumber += "-01";
  document.getElementById("id_ivm_itemNumber").value = partNumber;
  return;
}

/****************************************************************
Function:  cdm_tableSort()
Description: Sorts the class data table based on clicked header.
*****************************************************************/
function cdm_tableSort(column)
{ 

  var sortDir = "ASC";
  
  var currentSort = document.getElementById("id_cmd_sortInfo").innerHTML;
  
  if(currentSort != "None")
  {
	var currentSortSplit = currentSort.split(":");
	var currentSortCol = currentSortSplit[0];
	var currentSortDir = currentSortSplit[1];
	
	if(currentSortCol == column)
	{
	  if(currentSortDir == "ASC")
		sortDir = "DESC";
	  else
	    sortDir = "ASC";
	}
	else
	{
	  sortDir = "ASC";
	}
  
  }

  sendBackendRequest("RetrieveClassData.php","SID="+getSID()+"&SortColumn="+column+"&SortDirection="+sortDir);
  
  document.getElementById("id_cmd_sortInfo").innerHTML = column + ":"+sortDir;  
}

/****************************************************************
Function:  cdm_loadRow()
Description: Loads a row of data into the edit box.
*****************************************************************/
function cdm_loadRow(id,className,part,qty,date)
{
	document.getElementById("id_cdm_idDisplay").innerHTML = id;
	document.getElementById("id_cdm_classInput").value = className;
	document.getElementById("id_cdm_PNInput").value = part;
	document.getElementById("id_cdm_qtyInput").value = qty;
	document.getElementById("id_cdm_dateInput").value = date;

	document.getElementById("id_cdm_deleteEntry").disabled = false;

	return;
}

/****************************************************************
Function:  cdm_clearEdit()
Description: Clears the edit box if a row is loaded into it.
*****************************************************************/
function cdm_clearEdit()
{
	if(document.getElementById("id_cdm_idDisplay").innerHTML != "New")
	{
		document.getElementById("id_cdm_idDisplay").innerHTML = "New";
		document.getElementById("id_cdm_classInput").value = "";
		document.getElementById("id_cdm_PNInput").value = "";
		document.getElementById("id_cdm_qtyInput").value = "";
		document.getElementById("id_cdm_dateInput").value = "";	
		
		document.getElementById("id_cdm_deleteEntry").disabled = true;

	}
	
	return;
}

/****************************************************************
Function:  cdm_deleteClassDataEntry()
Description: Delets a selected class data entry from the database.
*****************************************************************/
function cdm_deleteClassDataEntry()
{
	var id = document.getElementById("id_cdm_idDisplay").innerHTML;
	var sortCommand ="";
	if(id != "New")
	{
		var currentSort = document.getElementById("id_cmd_sortInfo").innerHTML;
		if(currentSort != "None")
		{
			var currentSortSplit = currentSort.split(":");
			var currentSortCol = currentSortSplit[0];
			var currentSortDir = currentSortSplit[1];
			
			sortCommand = "&SortColumn="+currentSortCol+"&SortDirection="+currentSortDir;
			
		}	
		
		sendBackendRequest("DeleteClassData.php","SID="+getSID()+"&ID="+id+sortCommand);
	}
	else
	{
		alert("No Class data record selected");
	}
	
	return;
}

/****************************************************************
Function:  cdm_addClassDataEntry()
Description: Sends new class data to the server to be saved.
*****************************************************************/
function cdm_addClassDataEntry()
{

  var className = document.getElementById("id_cdm_classInput").value;
  var partNumber = document.getElementById("id_cdm_PNInput").value;
  var qty = document.getElementById("id_cdm_qtyInput").value;
  var date = document.getElementById("id_cdm_dateInput").value;
  var sortCommand = "";
  
  var currentSort = document.getElementById("id_cmd_sortInfo").innerHTML;
  if(currentSort != "None")
  {
	var currentSortSplit = currentSort.split(":");
	var currentSortCol = currentSortSplit[0];
	var currentSortDir = currentSortSplit[1];
	
	sortCommand = "&SortColumn="+currentSortCol+"&SortDirection="+currentSortDir;	
  }	  

  sendBackendRequest("AddNewClassData.php","SID="+getSID()+"&Class="+className+"&PartNumber="+partNumber+"&Quantity="+qty+"&Date="+date+sortCommand);
  
  //clear entries
  document.getElementById("id_cdm_idDisplay").innerHTML = "New";
  document.getElementById("id_cdm_classInput").value = "";
  document.getElementById("id_cdm_PNInput").value = "";
  document.getElementById("id_cdm_qtyInput").value = "";
  document.getElementById("id_cdm_dateInput").value = "";	
  document.getElementById("id_cdm_deleteEntry").disabled = true;
  
  return;
}

/****************************************************************
Function:  cdm_getClassData()
Description: Sends a request to the server to retrieve the Class 
Data information for display.
*****************************************************************/
function cdm_getClassData()
{
  sendBackendRequest("RetrieveClassData.php","SID="+getSID());	
}

</script>
</head>
<body onload="populateForms()">

<nav class="w3-sidenav w3-blue" style="width:15%">
  <header class="w3-container">
  </header>
  <a href="MainPage.html">Home</a>
  <a href="AddItem.html">Add Item</a>
  <a href="Settings.html">Settings</a>   
  <a href="ActivityLog.html">Alerts</a> 
  <a href="ClassModification.html">Class List</a> 
  <a href="ShoppingList.html">Shopping List</a> 
  <br> 
  <div style="padding-left:5%">Quick Update:</div>
  <span style="padding-left:5%"><textarea type="text" rows="1" cols="19" maxlength="18" id="id_qa_ID" name="quickID" placeholder="PartID"></textarea></span>
  <span style="padding-left:5%"><textarea type="text" rows="1" cols="19" maxlength="18" id="id_qa_Description" name="quickDescription" placeholder="Description"></textarea></span> 
  <span style="padding-left:5%"><textarea type="text" rows="6" cols="19" maxlength="115" id="id_qa_Quantity" name="quickQuantity" placeholder="Quantity"></textarea></span> 
  <span style="padding-left:5%"><button class='button' type='button'>Update</button></span>
</nav>

<div class="w3-container w3-blue" style="margin-left:15%">
<form class="w3-form">
  <div class="w3-group">
  <a>SID:</a>
  <a id="id_main_SIDDisplay"></a>
  <br>
	<form>
	<font size="3">Search:</font><br>
	<input list="id_search_queryList" type="text" id="id_search_bar" name="search" oninput="showAutocomplete(this.value)">
	<datalist id="id_search_queryList">
	</datalist>
	<!-- <a class='button'>Search</a> -->
	<a href='AdvancedSearch.html' class='button'>Advanced Search</a>
	</form>
  </div>
</form>
</div>


<div class="w3-container" style="margin-left:15%">
<h2>Browser</h2>
<span style="padding-left:2px"></span>
<button class="button" type="button" onclick="document.getElementById('ItemViewModal').style.display='block'">Add Item</button>
<button class="button" type="button" onclick="document.getElementById('ClassDataModal').style.display='block'">Class Data</button>
<button class="button" type="button" onclick="loadBrowser()">Refresh</button>
<div id="table-wrapper">
  <div id="table-scroll">
    <table id="browser">
    </table>
  </div>
</div>
</div>

<br>

<div class="w3-container" style="margin-left:15%">
<h2>Log</h2>
<button class="button" type="button" onclick="loadLog()">Refresh</button>
<div id="table-wrapper">
  <div id="table-scroll">
    <table id="log">
    </table>
  </div>
</div>

</div>

</div>

<div style="margin-left:15%">


</div>

<footer class="w3-container w3-blue w3-row" style="margin-left:15%">
<div class="w3-container w3-third w3-red">
<p id="status_code"></p>
</div>
<div class="w3-container w3-twothird w3-teal">
<p id="status_message"></p>
</div>
</footer>


<!-- Modal Dialog box for Viewing Editing Single Item -->
<div id="ItemViewModal" class="w3-modal">
  <div class="w3-modal-content w3-blue" style="width:95%">
    <div class="w3-container">
	<header class="w3-container w3-blue">	  
      <span onclick="document.getElementById('ItemViewModal').style.display='none'" 
      class="w3-closebtn">&times;</span>
	  <h3>Add Item</h3>
	 </header>
      <form class="w3-container">
	  
	    <div class="w3-container w3-half">
		  <select class="w3-select w3-border" name="option" id="id_ivm_type" onchange="ivm_autoPN()">
			<option value="" disabled selected>Select Type</option>
			<option value="Capacitor">Capacitor</option>
			<option value="Resistor">Resistor</option>
			<option value="Inductor">Inductor</option>
			<option value="Equipment">Equipment</option>
			<option value="Transistor">Transistor</option>
			<option value="Transformer">Transformer</option>
			<option value="Other">Other</option>
		  </select>
		  <label>Type</label>
		</div>
		
		<div class="w3-container w3-half">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_value" oninput="ivm_autoPN()">
		  <label>Value</label>
		  <p>
		</div>
		
		<div class="w3-container">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_desc">
		  <label>Description</label>
		  <p>
		</div>	

		<div class="w3-container w3-half">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_supplierPN">
		  <label>Supplier Part Number</label>
		  <p>
		</div>		

		<div class="w3-container w3-half">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_supplierName">
		  <label>Supplier Name</label>
		  <p>
		</div>
		
		<div class="w3-container">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_link">
		  <label>Document URL</label>
		  <p>
		</div>

		<div class="w3-container w3-quarter">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_qty">
		  <label>Quantity</label>
		  <p>
		</div>
		
		<div class="w3-container w3-quarter">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_thresh">
		  <label>Threshold</label>
		  <p>
		</div>
		
		<div class="w3-container w3-half">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_location">
		  <label>Location</label>
		  <p>
		</div>
		
		<div class="w3-container">
		  <input class="w3-input w3-border w3-text-black" type="text" id="id_ivm_itemNumber">
		  <label>Item Number</label>
		  <p>
		</div>
		
		
		<button class="w3-btn w3-light-green w3-border w3-round-large" type="button" onclick="createNewItem()">Create Item</button>
		<p>
		
		<footer class="w3-container w3-blue w3-row">
		  <p></p>
		</footer>
		
	  </form>
    </div>
  </div>
</div>

<!-- Class Data Modal Dialog Box -->
<div id="ClassDataModal" class="w3-modal">
  <div class="w3-modal-content w3-blue" style="width:95%">
    <div class="w3-container">
	<header class="w3-container w3-blue">
      <span onclick="document.getElementById('ClassDataModal').style.display='none'" 
      class="w3-closebtn">&times;</span>
	  <h3>Class Data</h3>
	</header>
	<div id="id_cmd_sortInfo" style="display: none;">None</div>
	<div id="id_cdm_table" class="w3-white">
	</div>
	 
	<div class="w3-container">
		<a>ID:</a>
		<a id="id_cdm_idDisplay">New</a>
	</div>
	<form class="w3-container">
	<div class="w3-container w3-quarter">
		<input class="w3-input w3-border w3-text-black" type="text" id="id_cdm_classInput" placeholder="" onclick="cdm_clearEdit()">
		<label>Class</label>
	</div>
	<div class="w3-container w3-quarter">
		<input class="w3-input w3-border w3-text-black" type="text" id="id_cdm_PNInput" placeholder="" onclick="cdm_clearEdit()">
		<label>Part Number</label>
	</div>
	<div class="w3-container w3-quarter">
		<input class="w3-input w3-border w3-text-black" type="text" id="id_cdm_qtyInput" placeholder="" onclick="cdm_clearEdit()">
		<label>Quantity Needed</label>
	</div>
	<div class="w3-container w3-quarter">
		<input class="w3-input w3-border w3-text-black" type="text" id="id_cdm_dateInput" placeholder="" onclick="cdm_clearEdit()">
		<label>Date Needed</label>
	</div>
	<p/>	
	<button class="w3-btn w3-light-green w3-border w3-round-large" type="button" onclick="cdm_addClassDataEntry()">Add Class Data</button>
	<button class="w3-btn w3-red w3-border w3-round-large" type="button" onclick="cdm_deleteClassDataEntry()" id="id_cdm_deleteEntry" disabled>Delete</button>
	<p/>
	</form>  
	<footer class="w3-container w3-blue w3-row">
		<p/>
	</footer>  
    </div>
  </div>
</div>

         
</body>
</html>